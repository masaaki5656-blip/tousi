import React, { useState } from 'react';
import { 
  LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, Cell, LabelList, AreaChart, Area
} from 'recharts';
import { 
  TrendingUp, AlertTriangle, ShieldCheck, DollarSign, Briefcase, 
  ArrowRight, Landmark, PieChart, Snowflake 
} from 'lucide-react';

const AssetManagementDashboard = () => {
  const [activeTab, setActiveTab] = useState('summary');

  // --- データセット定義 ---

  // 1. マネーサプライ（日米M2）イメージ
  const moneySupplyData = [
    { year: '2015', jpy: 100, usd: 100 },
    { year: '2017', jpy: 108, usd: 112 },
    { year: '2019', jpy: 115, usd: 125 },
    { year: '2021', jpy: 130, usd: 160 }, // コロナ緩和
    { year: '2023', jpy: 140, usd: 158 }, // 米国引き締め
    { year: '2025', jpy: 148, usd: 165 }, // 現在
    { year: '2027(予)', jpy: 160, usd: 175 }, // 日本は緩和継続、円が溢れる
  ];

  // 2. 過去30年の実績 (1995-2025)
  const pastData = [
    { year: '1995', sp500: 100, gold: 100, cash: 100 },
    { year: '2005', sp500: 210, gold: 160, cash: 101 },
    { year: '2015', sp500: 450, gold: 350, cash: 100 },
    { year: '2025', sp500: 1450, gold: 850, cash: 75 }, // 現金はインフレで価値減
  ];

  // 3. 未来予測 (2025-2045) ゴールドマン・サックス等の予測反映
  const futureData = [
    { year: '2025', orkan: 100, sp500: 100 },
    { year: '2030', orkan: 150, sp500: 135 }, // 新興国・日本株の回復
    { year: '2035', orkan: 220, sp500: 180 },
    { year: '2040', orkan: 330, sp500: 250 },
    { year: '2045', orkan: 480, sp500: 340 }, // オルカン優位へ
  ];

  // 4. 金・税引後手取りシミュレーション (投資額1000万・30年後)
  const goldTaxData = [
    { name: '① GLDM (ETF)', amount: 3591, fill: '#10B981', desc: '税率約20% (分離課税)' },
    { name: '② 金現物', amount: 3512, fill: '#F59E0B', desc: '総合課税 (累進税率)' },
    { name: '③ アクティブ投信', amount: 2963, fill: '#6B7280', desc: '信託報酬で目減り' },
  ];

  // --- コンポーネント ---

  const SectionHeader = ({ icon: Icon, title, subtitle }) => (
    <div className="flex items-start mb-6 border-b pb-4 border-slate-200">
      <div className="p-3 bg-slate-100 rounded-lg mr-4">
        <Icon className="text-slate-700" size={24} />
      </div>
      <div>
        <h2 className="text-xl md:text-2xl font-bold text-slate-800">{title}</h2>
        <p className="text-slate-500 text-sm mt-1">{subtitle}</p>
      </div>
    </div>
  );

  return (
    <div className="min-h-screen bg-slate-50 font-sans text-slate-800 p-4 md:p-8">
      <div className="max-w-6xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden">
        
        {/* Header Area */}
        <header className="bg-slate-900 text-white p-8 md:p-12">
          <div className="flex flex-col md:flex-row justify-between items-start md:items-center">
            <div>
              <h1 className="text-3xl md:text-4xl font-bold mb-4">資産防衛・運用戦略レポート</h1>
              <p className="text-slate-300 text-lg">「円安・インフレ」時代を生き抜くための最適解</p>
            </div>
            <div className="mt-6 md:mt-0 bg-red-600/20 border border-red-500/50 p-4 rounded-lg backdrop-blur-sm">
              <div className="flex items-center text-red-100 font-bold mb-1">
                <Snowflake className="mr-2" /> 警告：円は「溶ける氷」
              </div>
              <p className="text-xs text-red-200">
                現金のままで持つことは、<br/>毎日資産を捨てているのと同じです。
              </p>
            </div>
          </div>
        </header>

        {/* Executive Summary (Conclusion First) */}
        <section className="p-8 bg-blue-50 border-b border-blue-100">
          <h3 className="text-xl font-bold text-blue-900 mb-4 flex items-center">
            <TrendingUp className="mr-2" /> 結論：今すぐやるべきアクション
          </h3>
          <div className="grid md:grid-cols-2 gap-6">
            <div className="bg-white p-6 rounded-xl shadow-sm border-l-4 border-blue-600">
              <h4 className="font-bold text-lg mb-2 text-slate-800">1. 金（Gold）への投資</h4>
              <p className="text-slate-600 text-sm mb-3">
                「現物」ではなく<strong>「ETF（GLDM）」</strong>一択。<br/>
                税制メリットにより、最終手取り額が最大化します。
              </p>
              <div className="text-xs font-bold text-blue-600 bg-blue-50 inline-block px-2 py-1 rounded">
                推奨：SBI証券 / 楽天証券 で「GLDM」を購入
              </div>
            </div>
            <div className="bg-white p-6 rounded-xl shadow-sm border-l-4 border-emerald-500">
              <h4 className="font-bold text-lg mb-2 text-slate-800">2. 株式への投資</h4>
              <p className="text-slate-600 text-sm mb-3">
                米国株（S&P500）一点張りから<strong>「全世界株（オルカン）」</strong>へ。<br/>
                主要投資銀行は長期での「分散」優位を予測しています。
              </p>
              <div className="text-xs font-bold text-emerald-600 bg-emerald-50 inline-block px-2 py-1 rounded">
                推奨：eMAXIS Slim 全世界株式（オール・カントリー）
              </div>
            </div>
          </div>
        </section>

        {/* Main Content Tabs */}
        <div className="p-8">
          <div className="flex flex-wrap gap-2 mb-8 border-b border-slate-200 pb-1">
            {['macro', 'history', 'future', 'gold'].map((tab) => (
              <button
                key={tab}
                onClick={() => setActiveTab(tab)}
                className={`px-6 py-3 rounded-t-lg font-bold transition-all ${
                  activeTab === tab 
                  ? 'bg-slate-800 text-white' 
                  : 'bg-slate-100 text-slate-500 hover:bg-slate-200'
                }`}
              >
                {tab === 'macro' && '① なぜ円安？'}
                {tab === 'history' && '② 過去の実績'}
                {tab === 'future' && '③ 未来の予測'}
                {tab === 'gold' && '④ 金の最適解'}
              </button>
            ))}
          </div>

          {/* TAB 1: MACRO (Money Supply) */}
          {activeTab === 'macro' && (
            <div className="animate-fade-in">
              <SectionHeader 
                icon={Landmark} 
                title="日本円が弱くなり続ける構造的理由" 
                subtitle="マネーサプライ（市場に出回るお金の量）の格差"
              />
              <div className="grid md:grid-cols-2 gap-8 items-center">
                <div className="h-64 bg-white p-4 rounded-lg border border-slate-100 shadow-inner">
                  <ResponsiveContainer width="100%" height="100%">
                    <LineChart data={moneySupplyData}>
                      <CartesianGrid strokeDasharray="3 3" />
                      <XAxis dataKey="year" fontSize={12} />
                      <YAxis hide domain={['dataMin', 'dataMax']} />
                      <Tooltip />
                      <Legend />
                      <Line type="monotone" dataKey="jpy" name="日本円供給量" stroke="#ef4444" strokeWidth={3} />
                      <Line type="monotone" dataKey="usd" name="米ドル供給量" stroke="#3b82f6" strokeWidth={3} strokeDasharray="5 5" />
                    </LineChart>
                  </ResponsiveContainer>
                </div>
                <div className="space-y-4">
                  <div className="p-4 bg-red-50 rounded-lg border border-red-100">
                    <h4 className="font-bold text-red-800 mb-2">円の供給過多 ＝ 価値の希薄化</h4>
                    <p className="text-sm text-slate-700">
                      日本は金融緩和を継続しており、ドルの供給ペース以上に「円」が市場に溢れています。
                      モノ（金や株）に対して、円の価値が相対的に下がり続ける（＝円安）のは必然です。
                    </p>
                  </div>
                  <p className="text-slate-600 text-sm">
                    <strong>ポイント：</strong> 「円で貯金」しているだけで、あなたの資産は世界基準で見ると目減りし続けています。これを防ぐには、円を「価値のある資産」に変えるしかありません。
                  </p>
                </div>
              </div>
            </div>
          )}

          {/* TAB 2: HISTORY (30 Years) */}
          {activeTab === 'history' && (
            <div className="animate-fade-in">
              <SectionHeader 
                icon={TrendingUp} 
                title="【過去30年】勝者は「株式」だった" 
                subtitle="1995年を100とした場合の資産価値推移"
              />
              <div className="h-72 w-full bg-white p-4 rounded-lg border border-slate-100 shadow-inner mb-6">
                <ResponsiveContainer width="100%" height="100%">
                  <LineChart data={pastData}>
                    <CartesianGrid strokeDasharray="3 3" />
                    <XAxis dataKey="year" />
                    <YAxis />
                    <Tooltip />
                    <Legend />
                    <Line type="monotone" dataKey="sp500" name="米国株 (S&P500)" stroke="#3b82f6" strokeWidth={3} />
                    <Line type="monotone" dataKey="gold" name="金 (Gold)" stroke="#f59e0b" strokeWidth={2} />
                    <Line type="monotone" dataKey="cash" name="現金 (実質価値)" stroke="#9ca3af" strokeWidth={2} strokeDasharray="3 3" />
                  </LineChart>
                </ResponsiveContainer>
              </div>
              <div className="grid md:grid-cols-3 gap-4 text-sm">
                <div className="bg-blue-50 p-4 rounded text-blue-900">
                  <strong>株式の圧勝:</strong> 過去は米国株が最強でした。金も上昇しましたが、株式の成長力には及びません。
                </div>
                <div className="bg-amber-50 p-4 rounded text-amber-900">
                  <strong>金の役割:</strong> 株式ほどの爆発力はありませんが、暴落時の保険としての「守り」に優れています。
                </div>
                <div className="bg-gray-100 p-4 rounded text-gray-600">
                  <strong>現金の敗北:</strong> インフレにより、30年前の100万円は、現在の商品価値でいうと75万円程度まで低下しています。
                </div>
              </div>
            </div>
          )}

          {/* TAB 3: FUTURE (Forecast) */}
          {activeTab === 'future' && (
            <div className="animate-fade-in">
              <SectionHeader 
                icon={PieChart} 
                title="【今後20年】プロの予測は「分散」へ" 
                subtitle="ゴールドマン・サックス等の長期市場予測"
              />
              <div className="grid md:grid-cols-2 gap-8 mb-6">
                <div className="h-64 bg-white p-4 rounded-lg border border-slate-100 shadow-inner">
                   <ResponsiveContainer width="100%" height="100%">
                    <LineChart data={futureData}>
                      <CartesianGrid strokeDasharray="3 3" />
                      <XAxis dataKey="year" />
                      <YAxis />
                      <Tooltip />
                      <Legend />
                      <Line type="monotone" dataKey="orkan" name="全世界株 (オルカン)" stroke="#10b981" strokeWidth={3} />
                      <Line type="monotone" dataKey="sp500" name="米国株 (S&P500)" stroke="#3b82f6" strokeWidth={2} strokeDasharray="5 5" />
                    </LineChart>
                  </ResponsiveContainer>
                </div>
                <div className="flex flex-col justify-center space-y-4">
                  <div className="bg-emerald-50 p-4 rounded-lg border border-emerald-100">
                    <h4 className="font-bold text-emerald-800 mb-2">なぜ「オルカン」なのか？</h4>
                    <ul className="list-disc list-inside text-sm text-slate-700 space-y-2">
                      <li>米国株は現在「割高」であり、今後10年はリターンが鈍化する予測（GS予測：年率3%程度へ低下）。</li>
                      <li>一方で、新興国やその他の国への見直し買いが入る可能性が高い。</li>
                      <li>「どの国が勝ってもいい」状態を作るのが最強の戦略。</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* TAB 4: GOLD (Tax Simulation) */}
          {activeTab === 'gold' && (
            <div className="animate-fade-in">
              <SectionHeader 
                icon={ShieldCheck} 
                title="金投資の結論：GLDM一択の理由" 
                subtitle="30年後の「税引後手取り額」シミュレーション"
              />
              <div className="grid md:grid-cols-2 gap-8 items-center mb-6">
                 <div className="h-72 w-full">
                  <ResponsiveContainer width="100%" height="100%">
                    <BarChart layout="vertical" data={goldTaxData} margin={{ left: 20 }}>
                      <CartesianGrid strokeDasharray="3 3" horizontal={false} />
                      <XAxis type="number" hide />
                      <YAxis type="category" dataKey="name" width={110} tick={{fontSize: 11, fontWeight: 'bold'}} />
                      <Tooltip cursor={{fill: 'transparent'}} />
                      <Bar dataKey="amount" radius={[0, 4, 4, 0]} barSize={30}>
                        {goldTaxData.map((entry, index) => (
                          <Cell key={`cell-${index}`} fill={entry.fill} />
                        ))}
                        <LabelList dataKey="amount" position="right" formatter={(val) => `${val}万`} style={{ fill: '#333', fontWeight: 'bold' }} />
                      </Bar>
                    </BarChart>
                  </ResponsiveContainer>
                </div>
                <div className="space-y-4">
                  <div className="bg-slate-50 p-4 rounded-lg border border-slate-200">
                    <h4 className="font-bold text-slate-800 mb-2">なぜこれほど差が出るのか？</h4>
                    <ul className="space-y-3 text-sm text-slate-600">
                      <li className="flex items-start">
                        <span className="text-emerald-500 mr-2">●</span>
                        <span>
                          <strong>GLDM (ETF):</strong> 税率が約20%で固定（分離課税）。高所得者ほど有利。
                        </span>
                      </li>
                      <li className="flex items-start">
                        <span className="text-amber-500 mr-2">●</span>
                        <span>
                          <strong>金現物:</strong> 利益が給与所得と合算される「総合課税」。年収が高いと最高で約55%の税金がかかるため、利益が半分消える。
                        </span>
                      </li>
                      <li className="flex items-start">
                        <span className="text-gray-500 mr-2">●</span>
                        <span>
                          <strong>投資信託:</strong> 「信託報酬」という手数料が毎年引かれるため、30年の複利効果でボディブローのように効いてくる。
                        </span>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          )}

        </div>

        {/* Footer / Action Plan */}
        <div className="bg-slate-800 text-white p-8">
          <h3 className="text-xl font-bold mb-6 text-center">最終アクションプラン</h3>
          <div className="grid md:grid-cols-2 gap-6 max-w-4xl mx-auto">
            <div className="bg-slate-700 p-6 rounded-lg">
              <h4 className="font-bold text-emerald-400 mb-2">1. 証券口座を開く</h4>
              <p className="text-sm text-slate-300 mb-4">
                以下のネット証券が手数料最安クラスです。<br/>対面型の銀行や証券会社は手数料が高いのでNG。
              </p>
              <ul className="text-sm space-y-2">
                <li className="flex items-center"><ArrowRight size={16} className="mr-2"/> SBI証券</li>
                <li className="flex items-center"><ArrowRight size={16} className="mr-2"/> 楽天証券</li>
                <li className="flex items-center"><ArrowRight size={16} className="mr-2"/> マネックス証券</li>
              </ul>
            </div>
            <div className="bg-slate-700 p-6 rounded-lg">
              <h4 className="font-bold text-yellow-400 mb-2">2. 買うべき銘柄（ティッカー）</h4>
              <p className="text-sm text-slate-300 mb-4">
                検索窓に以下のコードを入れて購入設定をするだけです。
              </p>
              <ul className="space-y-3">
                <li className="border-b border-slate-600 pb-2">
                  <div className="font-bold">金（Gold）</div>
                  <div className="text-sm text-yellow-400">GLDM (SPDR Gold MiniShares)</div>
                </li>
                <li>
                  <div className="font-bold">全世界株式</div>
                  <div className="text-sm text-emerald-400">eMAXIS Slim 全世界株式（オール・カントリー）</div>
                </li>
              </ul>
            </div>
          </div>
          <div className="mt-8 text-center text-slate-400 text-sm">
            ※投資は自己責任ですが、インフレで現金の価値が下がるリスクもまた「自己責任」です。<br/>
            早めの行動が、将来の自分を守ります。
          </div>
        </div>
      </div>
    </div>
  );
};

export default AssetManagementDashboard;
